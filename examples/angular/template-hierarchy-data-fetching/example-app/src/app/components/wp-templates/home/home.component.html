<main>
  <div class="container">
    <!-- Page Title -->
    <section class="page-header">
      <h1>{{ pageTitle() }}</h1>   
    </section>

    <!-- Loading state (initial load) -->
    <section *ngIf="loading() && allPosts().length === 0">
      <app-loading text="Loading posts..."></app-loading>
    </section>

    <!-- Error state -->
    <section *ngIf="error() && !loading()">
      <div class="error-container">
        <h2>Error Loading Posts</h2>
        <p>{{ error() }}</p>
        <button 
          (click)="refreshPosts()" 
          class="btn btn-primary">
          Try Again
        </button>
      </div>
    </section>

    <!-- Posts listing -->
    <section *ngIf="!loading() && !error() && allPosts().length > 0">
      <app-post-listing 
        [posts]="allPosts()" 
        [loading]="false" 
        [cols]="3">
      </app-post-listing>

      <!-- Load More Section -->
      <div class="load-more-section" *ngIf="hasMorePosts()">
        <div *ngIf="loadingMore()" class="loading-more">
          <app-loading text="Loading more posts..."></app-loading>
        </div>
        
        <button 
          *ngIf="!loadingMore()" 
          (click)="loadMorePosts()" 
          class="btn btn-primary btn-large">
          Load More Posts
          <span class="posts-count">({{ getPostsCount() }} loaded)</span>
        </button>
      </div>
    </section>

    <!-- Empty state -->
    <section *ngIf="!loading() && !error() && allPosts().length === 0">
      <app-empty-state 
        [text]="'No ' + (category ? 'posts found in this category' : tag ? 'posts found with this tag' : 'blog posts found') + '.'">
      </app-empty-state>
    </section>
  </div>
</main>